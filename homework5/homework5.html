<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>Symbol Map Demo</title>

    <!-- load D3 and TopoJSON //-->
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="http://d3js.org/topojson.v1.min.js"></script>
    <script src="http://d3js.org/d3.geo.projection.v0.min.js"></script>


    <!-- load custom CSS and JavaScript //-->
    <link rel="stylesheet" href="style.css">
    <script src="homework5.js"></script>

 </head>
<body>
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-theme.min.css" rel="stylesheet">
<style type="text/css">
    body {
        padding-top: 20px;
        padding-bottom: 20px;
    }
</style>

<!-- Fixed Navbar -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">MSN 622</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="/information_visualization/#homework">Homework</a></li>
                <li><a href="/information_visualization/#project">Project</a></li>
                <li><a href="/information_visualization/#participation">Participation</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="/information_visualization/#about">About</a></li>
                <li><a href="/information_visualization/#contact">Contact</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class="jumbotron">
    <div class="container">
        <h2>Homework 5: Earthquake Visualisation</h2>
        <h4>Alice Priyanka Benziger</h4>

       
    </div>
</div>
<body>

<div id="block">
<svg id="map" width="1020" height="480"></svg>
<p id="log">Loading map... please wait.</p>
</div>

<script>
/*
 * For sample TopoJSON files, go to:
 * https://gist.github.com/mbostock/4090846
 */
var base = "https://gist.githubusercontent.com/mbostock/4090846/raw/";
var url = {
    world: base + "world-50m.json",
    earthquakes:  "4.5_month.csv"
    // precip:  "usprecip.json" // relative URL
};

// Uses reusable chart model
// See http://bost.ocks.org/mike/chart/
var chart = symbolMap();

// Update how we access data (need the precip property)
chart = chart.value(function(d) { return d.mag; });

// Nested calls to trigger drawing in proper order
d3.json(url.world, function(mapError, mapJSON) {
    if (processError(mapError)) return;

    // update map data
    chart = chart.map(mapJSON);

    // Wait until the map is drawn before loading
    // and drawing the data values
    d3.csv(url.earthquakes, function(dataError, dataJSON) {
        if (processError(dataError)) return;

        chart = chart.values(dataJSON);
        chart("map");
    });
});

// Load state lookup information
// Possible some lookups will fail until this loads
// d3.tsv(url.states, parseStateName, function(error, data) {
//         if (processError(error)) return;
//         chart = chart.lookup(data);
//     }
// );

</script>

</body>
</html>


<div class="container">
<h1>Functionality</h1>

  <p style ="font-size:18px"> Basic functionality </p>
  <p style ="font-size:15px"> Line and Area plots </p>
  <ul>
    <li> I started visualising data using a multi-series line chart with the total number accidents involving drivers, front and rear seat passengers. </li>
    <li> The multi-series line chart shows drivers dominating the accident numbers.</li>
    <li> From this point, I focussed only on driver related accidents. I obtained a single line plot for the number of accidents involving drivers over the years</li>
    <li> Also obtained an area chart with the number of drivers involved in accidents over the years. </li>
  </ul>
  <p style ="font-size:18px"> Moderate functionality </p>
  <p style ="font-size:15px"> Panning and Tooltips added </p>

  <ul>
    <li> A tooltip is added to the single line plot. Upon hovering over the line, a tooltip pops up with the exact x and y axis details.</li>
    <li> A panning feature is added to the area plot. For this a sub chart is obtained below the area plot. Brush over the subplot and scroll the brushed area with the mouse to obtain the panning feature </li>

  </ul>
  <p style ="font-size:18px"> Advanced functionality </p>
  <p style ="font-size:15px"> Brushing </p>

  <ul>
    <li> A sub area plot is added on the area chart. Brushing over the sub chart below displays the selected portion on the main chart. </li>
  </li>
  </ul>

<h1>Data preprocessing & Discussion</h1>

  <p> This D3 visualization analyzes the Seatbelts dataset available in R. It is a time series object in R that describes the number of accidents involving drivers, front and rear seat passengers, the number of deaths of both car and van drivers before and after a law making seatbelts compulsory in the UK. The data set also contains information like petrol prices and kilometers travelled on road each year on a monthly basis. Data is available from 1969 to 1985. Since the data frame was a time series object in R, exporting it to a csv directly would chop off the year and month details. The data set had to be preprocessed first by using time()(rounded off) and cycle() functions to obtained the year and months respectively. The time and year thus obtained had to be pasted to get date in a format "%Y%m" (Ex 197012 for Dec 1970). This is then exported in a csv to be visualised in d3. I used three main plots to visualise the data. I started visualising the number of accidents involving drivers, front and rear seat passengers on a multi-series line plot. From this plot, accidents involving drivers were higher compared to passengers. Hence focussed further on drivers involved in accidents. I used basic area and line charts to plot the accidents involving drivers. Both the area and line plot shows a decrease in accidents after the law making seatbelts strict was released. A tooltip feature is added on the line plot that gives the exact date and the number of accidents at a point in time upon hovering. A brushing and panning feature is added on to area chart. The brush feature helps focus on a small area of the plot helping to drill information down to months. A panning feature is also added on the are plot that helps to select a subregion and pan across. For implementation details, please over the <h10><a href="https://github.com/alicebenzi/information_visualization/blob/gh-pages/homework3.html">source code.</a></h10>
  </p>
</div>

